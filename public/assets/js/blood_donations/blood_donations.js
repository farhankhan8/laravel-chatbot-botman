(()=>{"use strict";$("#bloodDonationTable").DataTable({processing:!0,serverSide:!0,order:[[0,"desc"]],ajax:{url:bloodDonationUrl},columnDefs:[{targets:[2],orderable:!1,className:"text-center",width:"8%"},{targets:[1],className:"text-right"},{targets:"_all",defaultContent:"N/A"}],columns:[{data:"blooddonor.name",name:"blooddonor.name"},{data:"bags",name:"bags"},{data:function(o){var a=[{id:o.id}];return prepareTemplateRender("#bloodDonationActionTemplate",a)},name:"id"}]});$(document).on("submit","#addNewForm",(function(o){o.preventDefault();var a=jQuery(this).find("#btnSave");a.button("loading"),$.ajax({url:bloodDonationCreateUrl,type:"POST",data:$(this).serialize(),success:function(o){o.success&&(displaySuccessMessage(o.message),$("#addModal").modal("hide"),$("#bloodDonationTable").DataTable().ajax.reload(null,!1),setTimeout((function(){a.button("reset")}),2500))},error:function(o){printErrorMessage("#validationErrorsBox",o),setTimeout((function(){a.button("reset")}),2e3)}})})),$(document).on("submit","#editForm",(function(o){o.preventDefault();var a=jQuery(this).find("#btnEditSave");a.button("loading");var e=$("#bloodDonationId").val();$.ajax({url:bloodDonationUrl+"/"+e,type:"post",data:$(this).serialize(),success:function(o){o.success&&(displaySuccessMessage(o.message),$("#editModal").modal("hide"),$("#bloodDonationTable").DataTable().ajax.reload(null,!1))},error:function(o){manageAjaxErrors(o)},complete:function(){a.button("reset")}})})),$("#addModal").on("hidden.bs.modal",(function(){$("#donorName").val("").trigger("change.select2"),resetModalForm("#addNewForm","#validationErrorsBox")})),$("#editModal").on("hidden.bs.modal",(function(){resetModalForm("#editForm","#editValidationErrorsBox")})),window.renderData=function(o){$.ajax({url:bloodDonationUrl+"/"+o+"/edit",type:"GET",success:function(o){if(o.success){var a=o.data;$("#bloodDonationId").val(a.id),$("#editDonorName").val(a.blood_donor_id),$("#editDonorName").trigger("change"),$("#editBags").val(a.bags),$("#editModal").modal("show"),ajaxCallCompleted()}},error:function(o){manageAjaxErrors(o)}})},$(document).on("click",".edit-btn",(function(o){if(!ajaxCallIsRunning){ajaxCallInProgress();var a=$(o.currentTarget).data("id");renderData(a)}})),$(document).on("click",".delete-btn",(function(o){var a=$(o.currentTarget).data("id");deleteItem(bloodDonationUrl+"/"+a,"#bloodDonationTable","Blood Donation")})),$(document).ready((function(){$("#donorName,#editDonorName").select2({width:"100%"}),$("#addModal, #editModal").on("shown.bs.modal",(function(){$("#donorName, #editDonorName:first").focus()}))}))})();