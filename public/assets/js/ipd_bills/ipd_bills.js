(()=>{var e=0,t=0,a=0,n=0,s=0,o=0,r=0,l=0,i=0;$(document).ready((function(){1==billstaus&&$(" #discountPercent, #taxPercentage,#otherCharges ").prop("disabled",!0),calculateIpdBill(),a<=0&&($("#grossTotal").text(0),$(" #discountPercent, #taxPercentage,#otherCharges ").prop("disabled",!0))})),$(" #discountPercent, #taxPercentage, #otherCharges").on("keyup",(function(){"discountPercent"!=this.id&&"taxPercentage"!=this.id||parseInt(removeCommas($(this).val()))>100&&$(this).val(100),calculateIpdBill()})),$(document).on("submit","#ipdBillForm",(function(n){n.preventDefault(),$(" #discountPercent, #taxPercentage,#otherCharges").prop("disabled",!1),screenLock(),$("#saveIpdBillbtn").attr("disabled",!0);var s=jQuery(this).find("#saveIpdBillbtn");s.button("loading"),calculateIpdBill();var o=new FormData($(this)[0]);o.append("total_charges",e),o.append("total_payments",t),o.append("gross_total",a),o.append("net_payable_amount",r),$.ajax({url:ipdBillSaveUrl,type:"POST",dataType:"json",data:o,processData:!1,contentType:!1,success:function(e){displaySuccessMessage(e.message),window.location.reload()},error:function(e){UnprocessableInputError(e),$("#saveIpdBillbtn").attr("disabled",!1)},complete:function(){screenUnLock(),s.button("reset")}})})),window.calculateIpdBill=function(){e=parseInt(removeCommas($("#totalCharges").text())),t=parseInt(removeCommas($("#totalPayments").text())),a=parseInt(removeCommas($("#grossTotal").text())),n=parseInt(removeCommas($("#discountPercent").val())),s=parseInt(removeCommas($("#taxPercentage").val())),o=parseInt(removeCommas($("#otherCharges").val())),n=isNaN(n)?0:n,s=isNaN(s)?0:s,o=isNaN(o)?0:o;l=percentage(n,e),i=percentage(s,e),(r=e+o+i-(t+l))>0?$("#billStatus").html("UnPaid"):(r=0,$("#billStatus").html("Paid")),$("#netPayabelAmount").text(addCommas(r))},window.percentage=function(e,t){return e/100*t}})();