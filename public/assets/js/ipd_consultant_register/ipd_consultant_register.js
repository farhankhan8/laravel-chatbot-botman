$(document).ready((function(){"use strict";var t="#tblIpdConsultantRegisters";$(t).DataTable({processing:!0,serverSide:!0,order:[[0,"desc"]],ajax:{url:ipdConsultantRegisterUrl,data:function(t){t.id=ipdPatientDepartmentId}},columnDefs:[{targets:[0,1,2],width:"10%"},{targets:[3],className:"text-center",orderable:!1,width:"4%"},{targets:"_all",defaultContent:"N/A"}],columns:[{data:function(t){return t},render:function(t){return null===t.applied_date?"N/A":moment(t.applied_date).format("Do MMM, Y h:mm A")},name:"applied_date"},{data:function(t){return'<a href="'+doctorUrl+"/"+t.doctor_id+'">'+t.doctor.user.full_name+"</a>"},name:"doctor.user.first_name"},{data:function(t){return t},render:function(t){return null===t.instruction_date?"N/A":moment(t.instruction_date).format("Do MMM, Y")},name:"instruction_date"},{data:function(t){var e=[{id:t.id}];return prepareTemplateRender("#ipdConsultantRegisterActionTemplate",e)},name:"doctor.user.last_name"}]});var e=function(){$(".appliedDate").datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD HH:mm:ss",useCurrent:!1,sideBySide:!0,widgetPositioning:{horizontal:"left",vertical:"bottom"},minDate:ipdPatientCaseDate})),$(".instructionDate").datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD",useCurrent:!1,sideBySide:!0,widgetPositioning:{horizontal:"left",vertical:"bottom"},minDate:ipdPatientCaseDate}))};e();var n=function(t){$(t).select2({placeholder:"Select Doctor",width:"100%"})};n(".doctorId"),$(document).on("click","#addItem",(function(){var t={doctors,uniqueId},o=prepareTemplateRender("#ipdConsultantInstructionItemTemplate",t);$(".ipd-consultant-item-container").append(o),n(".doctorId"),e(),uniqueId++,a()}));var a=function(){var t=1;if($(".ipd-consultant-item-container>tr").each((function(){$(this).find(".item-number").text(t),t++})),t-1==0){var e={doctors,uniqueId},a=prepareTemplateRender("#ipdConsultantInstructionItemTemplate",e);$(".ipd-consultant-item-container").append(a),n(".doctorId"),uniqueId++}};$(document).on("click",".deleteIpdConsultantInstruction",(function(){$(this).parents("tr").remove(),a()})),$(document).on("click",".delete-consultant-btn",(function(e){var n=$(e.currentTarget).data("id");deleteItem(ipdConsultantRegisterUrl+"/"+n,t,"IPD Consultant Instruction")})),$(document).on("submit","#addIpdConsultantNewForm",(function(e){e.preventDefault();var n=jQuery(this).find("#btnIpdConsultantSave");n.button("loading");var a={formSelector:$(this),url:ipdConsultantRegisterCreateUrl,type:"POST",tableSelector:t};newRecord(a,n,"#addConsultantInstructionModal")})),$(document).on("click",".edit-consultant-btn",(function(t){if(!ajaxCallIsRunning){ajaxCallInProgress();var e=$(t.currentTarget).data("id");renderConsultantData(e)}})),window.renderConsultantData=function(t){$.ajax({url:ipdConsultantRegisterUrl+"/"+t+"/edit",type:"GET",success:function(t){t.success&&($("#ipdEditConsultantId").val(t.data.id),$("#ipdEditAppliedDate").val(t.data.applied_date),$("#editDoctorId").val(t.data.doctor_id).trigger("change.select2"),$("#editInstructionDate").val(t.data.instruction_date),$("#editConsultantInstruction").val(t.data.instruction),$("#editIpdConsultantInstructionModal").modal("show"),ajaxCallCompleted())},error:function(t){manageAjaxErrors(t)}})},$(document).on("submit","#editIpdConsultantNewForm",(function(e){e.preventDefault();var n=jQuery(this).find("#btnEditIpdConsultantSave");n.button("loading");var a=$("#ipdEditConsultantId").val(),o=ipdConsultantRegisterUrl+"/"+a,r={formSelector:$(this),url:o,type:"POST",tableSelector:t};editRecord(r,n,"#editIpdConsultantInstructionModal")})),$("#addConsultantInstructionModal").on("hidden.bs.modal",(function(){resetModalForm("#addIpdConsultantNewForm","#validationErrorsBox"),$("#ipdConsultantInstructionTbl").find("tr:gt(1)").remove(),$(".doctorId").val(""),$(".doctorId").trigger("change")}))}));