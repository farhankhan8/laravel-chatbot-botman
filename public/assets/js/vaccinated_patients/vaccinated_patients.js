(()=>{"use strict";$("#vaccinatedPatientTable").DataTable({processing:!0,serverSide:!0,order:[[0,"desc"]],ajax:{url:vaccinatedPatientUrl},columnDefs:[{targets:[5],className:"text-center",orderable:!1,width:"8%"},{targets:[3],className:"text-center",width:"8%"},{targets:"_all",defaultContent:"N/A"}],columns:[{data:function(e){return'<a href="'+(patientUrl+"/"+e.patient.id)+'">'+e.patient.user.full_name+"</a>"},name:"patient.user.first_name"},{data:"vaccination.name",name:"vaccination.name"},{data:"vaccination_serial_number",name:"vaccination_serial_number"},{data:"dose_number",name:"dose_number"},{data:function(e){return e},render:function(e){return null===e.dose_given_date?"N/A":moment(e.dose_given_date).utc().format("Do MMM, Y h:mm A")},name:"dose_given_date"},{data:function(e){var a=[{id:e.id}];return prepareTemplateRender("#vaccinationPatientsActionTemplate",a)},name:"patient.user.last_name"}]});$(document).ready((function(){$("#patientName,#vaccinationName,#editPatientName,#editVaccinationName").select2({width:"100%"}),$("#editDoesGivenDate").datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD HH:mm:ss",useCurrent:!0,sideBySide:!0,maxDate:new Date})),$("#doesGivenDate").datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD HH:mm:ss",useCurrent:!0,sideBySide:!0,maxDate:moment().endOf("day"),widgetPositioning:{horizontal:"left",vertical:"bottom"}}))})),$("#addModal").on("shown.bs.modal",(function(){$("#doesGivenDate").val(moment().format("YYYY-MM-DD HH:mm:ss"))})),$(document).on("submit","#addNewForm",(function(e){e.preventDefault();var a=jQuery(this).find("#btnSave");a.button("loading"),$.ajax({url:vaccinatedPatientCreateUrl,type:"POST",data:$(this).serialize(),success:function(e){e.success&&(displaySuccessMessage(e.message),$("#addModal").modal("hide"),$("#vaccinatedPatientTable").DataTable().ajax.reload(null,!1),setTimeout((function(){a.button("reset")}),2500))},error:function(e){printErrorMessage("#validationErrorsBox",e),setTimeout((function(){a.button("reset")}),2e3)}})})),$("#addModal").on("hidden.bs.modal",(function(){$("#patientName").val("").trigger("change"),$("#vaccinationName").val("").trigger("change"),$("#doesGivenDate").data("DateTimePicker").date(null),resetModalForm("#addNewForm","#validationErrorsBox")})),$(document).on("click",".edit-btn",(function(e){if(!ajaxCallIsRunning){ajaxCallInProgress();var a=$(e.currentTarget).attr("data-id");renderData(a)}})),window.renderData=function(e){$.ajax({url:vaccinatedPatientUrl+"/"+e+"/edit",type:"GET",success:function(e){if(e.success){var a=e.data;$("#vaccinatedPatientId").val(a.id),$("#editPatientName").val(a.patient_id).trigger("change.select2"),$("#editVaccinationName").val(a.vaccination_id).trigger("change.select2"),$("#editSerialNo").val(a.vaccination_serial_number),$("#editDoseNumber").val(a.dose_number),$("#editDoesGivenDate").val(moment(a.dose_given_date).utc().format("YYYY-MM-DD HH:mm:ss")),$("#editDescription").val(a.description),$("#editModal").modal("show"),ajaxCallCompleted()}},error:function(e){manageAjaxErrors(e)}})},$(document).on("submit","#editForm",(function(e){e.preventDefault();var a=jQuery(this).find("#editBtnSave");a.button("loading");var t=$("#vaccinatedPatientId").val();$.ajax({url:vaccinatedPatientUrl+"/"+t+"/update",type:"post",data:$(this).serialize(),success:function(e){e.success&&(displaySuccessMessage(e.message),$("#editModal").modal("hide"),$("#vaccinatedPatientTable").DataTable().ajax.reload(null,!1))},error:function(e){manageAjaxErrors(e)},complete:function(){a.button("reset")}})})),$(document).on("click",".delete-btn",(function(e){var a=$(e.currentTarget).data("id");deleteItem(vaccinatedPatientUrl+"/"+a,"#vaccinatedPatientTable","Vaccinated Patient")}))})();