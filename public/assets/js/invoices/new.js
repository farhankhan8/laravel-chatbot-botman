$('input:text:not([readonly="readonly"])').first().blur(),$(document).ready((function(){"use strict";$("#patient_id, #status").select2({width:"100%"}),$("#patient_id").focus();var t=function(t){$(t).select2({placeholder:"Select Account",width:"100%"})};t(".accountId");var e=$("#invoice_date");e.datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD",useCurrent:!1,maxDate:moment()})),e.val(invoiceDate),window.isNumberKey=function(t,e){var n=t.which?t.which:event.keyCode;return!((46!==n||-1!==$(e).val().indexOf("."))&&(n<48||n>57))},$(document).on("click","#addItem",(function(){var e={accounts,uniqueId},i=prepareTemplateRender("#invoiceItemTemplate",e);$(".invoice-item-container").append(i),t(".accountId"),uniqueId++,n()}));var n=function(){var e=1;if($(".invoice-item-container>tr").each((function(){$(this).find(".item-number").text(e),e++})),e-1==0){var n={accounts,uniqueId},i=prepareTemplateRender("#invoiceItemTemplate",n);$(".invoice-item-container").append(i),t(".accountId"),uniqueId++}};$(document).on("click",".delete-invoice-item",(function(){$(this).parents("tr").remove(),n(),a()})),$(document).on("keyup",".qty",(function(){var t=parseInt($(this).val()),e=$(this).parent().siblings().find(".price").val();e=parseInt(removeCommas(e));var n=i(t,e);$(this).parent().siblings(".amount").text(addCommas(n.toString())),a()})),$(document).on("keyup",".price",(function(){var t=$(this).val();t=parseInt(removeCommas(t));var e=parseInt($(this).parent().siblings().find(".qty").val()),n=i(e,t);$(this).parent().siblings(".amount").text(addCommas(n.toString())),a()}));var i=function(t,e){return t>0&&e>0?t*e:0},a=function(){var t=0;$(".invoice-item-container>tr").each((function(){var e=$(this).find(".item-total").text();e=removeCommas(e),e=isEmpty($.trim(e))?0:parseInt(e),t+=e})),t=parseFloat(t),$("#total").text(addCommas(t.toFixed(2))),$("#total_amount").val(t),o()},o=function(){var t=$("#discount").val(),e=removeCommas($("#total").text());(isEmpty(t)||isEmpty(e))&&(t=0);var n=e*t/100,i=e-n;$("#finalAmount").text(addCommas(i.toFixed(2))),$("#total_amount").val(i.toFixed(2)),$("#discountAmount").text(addCommas(n.toFixed(2)))};$(document).on("keyup","#discount",(function(t){o()})),$(document).on("submit","#invoiceForm",(function(t){t.preventDefault(),screenLock();var e=new FormData($(this)[0]);$.ajax({url:invoiceSaveUrl,type:"POST",dataType:"json",data:e,processData:!1,contentType:!1,success:function(t){displaySuccessMessage(t.message),window.location.href=invoiceUrl+"/"+t.data.id},error:function(t){printErrorMessage("#validationErrorsBox",t)},complete:function(){screenUnLock()}})}))}));