$(document).ready((function(){"use strict";$("#addModal, #EditModal").on("shown.bs.modal",(function(){$("#expenseId, #editExpenseHeadId:first").focus()})),$("#expenseId, #editExpenseHeadId,#expenseHead").select2({width:"100%"}),$("#date, #editDate").datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD",useCurrent:!0,sideBySide:!0})),$(document).on("click",".edit-btn",(function(e){if(!ajaxCallIsRunning){ajaxCallInProgress();var t=$(e.currentTarget).data("id");renderData(t)}})),window.renderData=function(e){$.ajax({url:expenseUrl+"/"+e+"/edit",type:"GET",success:function(e){if(e.success){var t=e.data.document_url.split(".").pop().toLowerCase();"pdf"==t?$("#editPreviewImage").attr("src",pdfDocumentImageUrl):"docx"==t||"doc"==t?$("#editPreviewImage").attr("src",docxDocumentImageUrl):""==t?$("#editPreviewImage").attr("src",defaultDocumentImageUrl):$("#editPreviewImage").attr("src",e.data.document_url),$("#editExpenseId").val(e.data.id),$("#editExpenseHeadId").val(e.data.expense_head).trigger("change.select2"),$("#editName").val(e.data.name),$("#editDate").val(format(e.data.date,"YYYY-MM-DD")),$("#editInvoiceNumber").val(e.data.invoice_number),$("#editAmount").val(e.data.amount),$(".price-input").trigger("input"),$("#editDescription").val(e.data.description),isEmpty(e.data.document_url)?$("#documentUrl").text(""):($("#documentUrl").html("View"),$("#documentUrl").attr("href",e.data.document_url)),$("#EditModal").modal("show"),ajaxCallCompleted()}},error:function(e){manageAjaxErrors(e)}})},$(document).on("submit","#editForm",(function(e){e.preventDefault(),$("#btnSave").attr("disabled",!0);var t=jQuery(this).find("#btnEditSave");t.button("loading");var a=$("#editExpenseId").val(),d=expenseUrl+"/"+a+"/update",o={formSelector:$(this),url:d,type:"POST"};editExpenseRecord(o,t)})),window.editExpenseRecord=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#EditModal",d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=""===e.formSelector?e.formData:new FormData($(e.formSelector)[0]);$.ajax({url:e.url,type:e.type,data:o,processData:!1,contentType:!1,success:function(e){e.success&&(displaySuccessMessage(e.message),$(a).modal("hide"),setTimeout((function(){window.location.reload()}),3e3))},error:function(e){UnprocessableInputError(e)},complete:function(){t.button("reset"),$(d).attr("disabled",!0)}})},$("#EditModal").on("hidden.bs.modal",(function(){resetModalForm("#editForm","#editValidationErrorsBox")})),$(document).on("change","#editAttachment",(function(){var e=isValidDocument($(this),"#editValidationErrorsBox");isEmpty(e)||0==e||($("#editValidationErrorsBox").html("").hide(),displayDocument(this,"#editPreviewImage",e))})),window.isValidDocument=function(e,t){var a=$(e).val().split(".").pop().toLowerCase();return-1==$.inArray(a,["png","jpg","jpeg","pdf","doc","docx"])?($(e).val(""),$(t).html(documentError).show(),!1):a}}));