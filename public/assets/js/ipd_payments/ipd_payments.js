(()=>{var __webpack_exports__={};function deleteItemAjax(url,tableId,header){var callFunction=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;$.ajax({url,type:"DELETE",dataType:"json",success:function success(obj){obj.success&&location.reload(),swal({title:"Deleted!",text:header+" has been deleted.",type:"success",timer:2e3}),callFunction&&eval(callFunction)},error:function(e){swal({title:"",text:e.responseJSON.message,type:"error",timer:5e3})}})}$(document).ready((function(){"use strict";var e="#tblIpdPayments";$(e).DataTable({processing:!0,serverSide:!0,order:[[1,"desc"]],ajax:{url:ipdPaymentUrl,data:function(e){e.id=ipdPatientDepartmentId}},columnDefs:[{targets:[0,1,2],width:"10%"},{targets:[0],className:"text-right"},{targets:[3],width:"5%"},{targets:[4],width:"20%"},{targets:[5],className:"text-center",orderable:!1,width:"4%",visible:actionAcoumnVisibal},{targets:"_all",defaultContent:"N/A"}],columns:[{data:function(e){return isEmpty(e.amount)?"N/A":'<p class="cur-margin">'+getCurrentCurrencyClass()+" "+addCommas(e.amount)+"</p>"},name:"amount"},{data:function(e){return e},render:function(e){return null===e.date?"N/A":moment(e.date).format("Do MMM, Y h:mm A")},name:"date"},{data:function(e){return ipdPaymentModes[e.payment_mode]},name:"payment_mode"},{data:function(e){return""!=e.ipd_payment_document_url?'<a href="'+(downloadPaymetDocumentUrl+"/"+e.id)+'">Download</a>':"N/A"},name:"id"},{data:"notes",name:"notes"},{data:function(e){var t=3==e.payment_mode,a=[{id:e.id,isPaymentModeStripe:t}];return prepareTemplateRender("#ipdPaymentActionTemplate",a)},name:"id"}]}),$("#ipdPaymentDate,#editIpdPaymentDate").datetimepicker(DatetimepickerDefaults({format:"YYYY-MM-DD HH:mm:ss",useCurrent:!0,sideBySide:!0,minDate:ipdPatientCaseDate,widgetPositioning:{horizontal:"right",vertical:"bottom"}})),$("#paymentModeId, #editPaymentModeId").select2({width:"100%"}),$(document).on("click",".ipdpayment-delete-btn",(function(t){var a=$(t.currentTarget).data("id"),n=ipdPaymentUrl+"/"+a;swal({title:"Delete !",text:'Are you sure want to delete this " IPD Payment " ?',type:"warning",showCancelButton:!0,closeOnConfirm:!1,showLoaderOnConfirm:!0,confirmButtonColor:"#5cb85c",cancelButtonColor:"#d33",cancelButtonText:"No",confirmButtonText:"Yes"},(function(){deleteItemAjax(n,e,"IPD Payment"),location.reload()}))})),$(document).on("click",".ipdpayment-edit-btn",(function(e){if(!ajaxCallIsRunning){ajaxCallInProgress();var t=$(e.currentTarget).data("id");renderData(t)}})),$(document).on("submit","#addIpdPaymentNewForm",(function(e){e.preventDefault();var t=jQuery(this).find("#btnIpdPaymentSave");t.button("loading");var a=new FormData($(this)[0]);$.ajax({url:ipdPaymentCreateUrl,type:"POST",dataType:"json",data:a,processData:!1,contentType:!1,success:function(e){e.success&&(displaySuccessMessage(e.message),$("#addIpdPaymentModal").modal("hide"),location.reload())},error:function(e){printErrorMessage("#paymentValidationErrorsBox",e)},complete:function(){t.button("reset")}})})),window.renderData=function(e){$.ajax({url:ipdPaymentUrl+"/"+e+"/edit",type:"GET",success:function(e){if(e.success){var t=e.data.ipd_payment_document_url.split(".").pop().toLowerCase();"pdf"==t?$("#editPaymentPreviewImage").attr("src",pdfDocumentImageUrl):"docx"==t||"doc"==t?$("#editPaymentPreviewImage").attr("src",docxDocumentImageUrl):""!=e.data.ipd_payment_document_url&&$("#editPaymentPreviewImage").attr("src",e.data.ipd_payment_document_url),$("#ipdPaymentId").val(e.data.id),$("#editIpdPaymentAmount").val(e.data.amount),$("#editIpdPaymentDate").val(moment(e.data.date).format("YYYY-MM-DD HH:mm:ss")),$("#editIpdPaymentNote").val(e.data.notes),$("#editPaymentModeId").val(e.data.payment_mode).trigger("change.select2"),$("#editIpdPaymentModal").modal("show"),ajaxCallCompleted()}},error:function(e){manageAjaxErrors(e)}})},$(document).on("submit","#editIpdPaymentForm",(function(t){t.preventDefault();var a=jQuery(this).find("#btnIpdPaymentSave");a.button("loading");var n=$("#ipdPaymentId").val(),o=ipdPaymentUrl+"/"+n,d={formSelector:$(this),url:o,type:"POST",tableSelector:e};editIpdPaymentRecord(d,a,"#editIpdPaymentModal")})),$("#addIpdPaymentModal").on("hidden.bs.modal",(function(){resetModalForm("#addIpdPaymentNewForm","#paymentValidationErrorsBox"),$("#paymentPreviewImage").attr("src",defaultDocumentImageUrl)})),$("#editIpdPaymentModal").on("hidden.bs.modal",(function(){resetModalForm("#editIpdPaymentForm","#editPaymentValidationErrorsBox")}))})),$(document).on("change","#paymentDocumentImage",(function(){var e=isValidDocument($(this),"#paymentValidationErrorsBox");isEmpty(e)||0==e||($("#paymentValidationErrorsBox").html("").hide(),displayDocument(this,"#paymentPreviewImage",e))})),$(document).on("change","#editPaymentDocumentImage",(function(){var e=isValidDocument($(this),"#editPaymentValidationErrorsBox");isEmpty(e)||0==e||($("#editValidationErrorsBox").html("").hide(),displayDocument(this,"#editPaymentPreviewImage",e))})),window.isValidDocument=function(e,t){var a=$(e).val().split(".").pop().toLowerCase();return-1==$.inArray(a,["png","jpg","jpeg","pdf","doc","docx"])?($(e).val(""),$(t).html("The document must be a file of type: jpeg, jpg, png, pdf, doc, docx.").show(),!1):a},window.editIpdPaymentRecord=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"#EditModal",n=""===e.formSelector?e.formData:new FormData($(e.formSelector)[0]);$.ajax({url:e.url,type:e.type,data:n,processData:!1,contentType:!1,success:function(e){e.success&&(displaySuccessMessage(e.message),$(a).modal("hide"),location.reload())},error:function(e){UnprocessableInputError(e)},complete:function(){t.button("reset")}})}})();